<!DOCTYPE html>
<!--
  ~ This file is part of gorilla-repl. Copyright (C) 2014, Jony Hudson.
  ~
  ~ gorilla-repl is licenced to you under the MIT licence. See the file LICENCE.txt for full details.
  -->

<html>
<head>
    <!-- TODO: local fonts -->
    <link href='https://fonts.googleapis.com/css?family=Lora:400,700' rel='stylesheet' type='text/css'/>
    <link href='https://fonts.googleapis.com/css?family=Arvo:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="jslib/codemirror-3.20/lib/codemirror.css"/>
    <link rel="stylesheet" href="css/worksheet-default.css"/>
    <script src="jslib/mathjax/MathJax.js?config=TeX-AMS-MML_SVG-full.js&delayStartupUntil=configured"></script>
    <script src="jslib/jquery-1.10.2.min.js"></script>
    <script src="jslib/knockout-3.0.0.min.js"></script>
    <script src="js/worksheet.js"></script>
    <script src="js/codemirror_ko_binding.js"></script>
    <script src="js/segment.js"></script>
    <script src="js/main.js"></script>
    <title>Gorilla REPL</title>
</head>
<body>

<!-- The page stub -->
<div id="contents">
    <div data-bind="template: {name: 'segment-template', data: worksheet().segmentTree()}">
    </div>
</div>
<div class="scroll-pad"></div>

<!-- Templates -->
<script type="text/html" id="segment-template">
    <div data-bind="template: {name: renderTemplate}"></div>
</script>

<script type="text/html" id="code-segment-template">
    <div class="segment code running"
         data-bind="css: {selected: cursor.selected, 'code-warning': warningIndicator() && cursor.selected(), running: runningIndicator}, attr: {id: id}, event: {keypress: handleSegmentKeypress}">
        <div class="btn-group pull-right">
            <a class="btn btn-mini dropdown-toggle" data-toggle="dropdown" href="#">
                <span class="settings-menu">
                    <i class="icon-wrench"></i>
                    <span class="caret"></span>
                </span>
            </a>
            <ul class="dropdown-menu">
                <li data-bind="click: visualToggleClicked">
                    <a href="#">Show output
                        <i class="pull-right" data-bind="css: {'icon-ok': visualPaneVisible}"></i></a>
                </li>
                <li data-bind="click: objectToggleClicked">
                    <a href="#">Show objects
                        <i class="pull-right" data-bind="css: {'icon-ok': objectBrowserVisible}"></i></a>
                </li>
                <li data-bind="click: liveModeClicked">
                    <a href="#">Live evaluation
                        <i class="pull-right" data-bind="css: {'icon-ok': liveEvaluationMode}"></i></a>
                </li>
            </ul>
        </div>
        <div class="output"
             data-bind="visible: visualPaneVisible, attr: {id: 'output-' + id()}, css: {visual: !$root.narrowMode(), 'visual-narrow': $root.narrowMode()}">
        </div>
        <div data-bind="css: {'segment-main': !$root.narrowMode(), 'segment-main-narrow': $root.narrowMode()}">
            <textarea class="codeTextArea" data-bind="codemirror: content"></textarea>
        </div>
        <div class="error-text" data-bind="text: errorText, visible: errorText() !== ''"></div>
        <div class="output browser"
             data-bind="objectViewer: output, visible: (objectBrowserVisible()), css: {'browser-muted': warningIndicator}"></div>
        <div class="segment-footer"></div>
    </div>
</script>

<script type="text/html" id="free-segment-template">
    <div class="segment free" data-bind="css: {selected: cursor.selected}, attr: {id: id}">
        <a href="#"
           data-bind="hasfocus: targetFocused, event: {keydown: cursor.handleSegmentKeydown},
                      attr: {id: 'segment-focus-target-' + id()}"></a>

        <div class="segment-main">
            <div class="free-preview"
                 data-bind="mathJaxViewer: content.renderedContent, click: cursor.handleSegmentClick, visible: !cursor.markupVisible()"></div>
            <div class="free-markup"
                 data-bind="visible: cursor.markupVisible, event: {keydown: content.handleMarkupKeyup}">
                <textarea data-bind="codemirror: content.markupEditor"></textarea>
            </div>
        </div>
        <div class="segment-footer"></div>
    </div>
</script>

<!-- Dialogs -->


</body>
</html>